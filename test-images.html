<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Loading Test - WoofCrafts</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #FAF7F3 0%, #E8D5B7 100%);
            padding: 40px 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #D4A574;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            text-align: center;
            color: #5C4A37;
            margin-bottom: 40px;
            font-size: 1.1rem;
        }
        
        .status {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .status h2 {
            color: #D4A574;
            margin-bottom: 15px;
        }
        
        .status-item {
            padding: 10px;
            margin: 5px 0;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }
        
        .status-item.success {
            background: #d4edda;
            color: #155724;
        }
        
        .status-item.error {
            background: #f8d7da;
            color: #721c24;
        }
        
        .status-item.info {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .card-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            background: #FAF7F3;
        }
        
        .card-content {
            padding: 20px;
        }
        
        .card-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #5C4A37;
            margin-bottom: 8px;
        }
        
        .card-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: #D4A574;
            margin-bottom: 8px;
        }
        
        .card-category {
            display: inline-block;
            padding: 5px 12px;
            background: #E8D5B7;
            color: #5C4A37;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .card-path {
            font-size: 0.8rem;
            color: #999;
            font-family: 'Courier New', monospace;
            word-break: break-all;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #eee;
        }
        
        .card-status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.85rem;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .card-status.loaded {
            background: #d4edda;
            color: #155724;
        }
        
        .card-status.failed {
            background: #f8d7da;
            color: #721c24;
        }
        
        .actions {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .btn {
            padding: 12px 25px;
            margin: 5px;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #D4A574 0%, #C9A961 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(212, 165, 116, 0.4);
        }
        
        .btn-secondary {
            background: #5C4A37;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #4a3b2d;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üêï WoofCrafts Image Loading Test</h1>
        <p class="subtitle">Testing product images from products.json</p>
        
        <div class="status">
            <h2>üìä Loading Status</h2>
            <div id="status-messages"></div>
        </div>
        
        <div id="products-grid" class="grid">
            <!-- Products will be loaded here -->
        </div>
        
        <div class="actions">
            <h2 style="color: #D4A574; margin-bottom: 15px;">üîß Test Actions</h2>
            <button class="btn btn-primary" onclick="location.reload()">üîÑ Refresh Test</button>
            <button class="btn btn-secondary" onclick="clearAndReload()">üóëÔ∏è Clear Cache & Reload</button>
            <button class="btn btn-primary" onclick="window.location.href='pos.html'">üõí Go to POS</button>
            <button class="btn btn-secondary" onclick="window.location.href='products.html'">üì¶ Manage Products</button>
        </div>
    </div>
    
    <script>
        let products = [];
        let loadedCount = 0;
        let failedCount = 0;
        
        function addStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status-messages');
            const item = document.createElement('div');
            item.className = `status-item ${type}`;
            item.textContent = message;
            statusDiv.appendChild(item);
        }
        
        function clearAndReload() {
            if (confirm('Clear localStorage and reload? This will reset all cached data.')) {
                localStorage.clear();
                addStatus('‚úì localStorage cleared!', 'success');
                setTimeout(() => location.reload(), 1000);
            }
        }
        
        async function loadProducts() {
            addStatus('üîç Loading products from products.json...', 'info');
            
            try {
                const response = await fetch('data/products.json');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                products = data.products;
                
                addStatus(`‚úì Successfully loaded ${products.length} products`, 'success');
                addStatus(`üìÅ File location: data/products.json`, 'info');
                
                renderProducts();
            } catch (error) {
                addStatus(`‚ùå Error loading products.json: ${error.message}`, 'error');
                console.error('Error:', error);
            }
        }
        
        function renderProducts() {
            const grid = document.getElementById('products-grid');
            
            if (products.length === 0) {
                grid.innerHTML = '<p style="text-align: center; grid-column: 1/-1; padding: 40px;">No products found!</p>';
                return;
            }
            
            grid.innerHTML = products.map(product => {
                const imagePath = product.image || '';
                
                return `
                    <div class="card" data-product-id="${product.id}">
                        <img 
                            src="${imagePath}" 
                            alt="${product.name}" 
                            class="card-image"
                            data-product-id="${product.id}"
                            onload="handleImageLoad(${product.id})"
                            onerror="handleImageError(${product.id}, '${imagePath}')"
                        >
                        <div class="card-content">
                            <div class="card-category">${product.category || 'General'}</div>
                            <div class="card-title">${product.name}</div>
                            <div class="card-price">$${parseFloat(product.price).toFixed(2)}</div>
                            <div class="card-path">üìÇ ${imagePath}</div>
                            <div class="card-status loading" id="status-${product.id}">‚è≥ Loading...</div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function handleImageLoad(productId) {
            loadedCount++;
            const statusEl = document.getElementById(`status-${productId}`);
            if (statusEl) {
                statusEl.className = 'card-status loaded';
                statusEl.textContent = '‚úì Loaded';
            }
            updateSummary();
        }
        
        function handleImageError(productId, imagePath) {
            failedCount++;
            const statusEl = document.getElementById(`status-${productId}`);
            if (statusEl) {
                statusEl.className = 'card-status failed';
                statusEl.textContent = '‚ùå Failed';
            }
            addStatus(`‚ùå Failed to load: ${imagePath}`, 'error');
            updateSummary();
        }
        
        function updateSummary() {
            const total = products.length;
            const tested = loadedCount + failedCount;
            
            if (tested === total && total > 0) {
                if (failedCount === 0) {
                    addStatus(`üéâ SUCCESS! All ${loadedCount} images loaded correctly!`, 'success');
                } else {
                    addStatus(`‚ö†Ô∏è Results: ${loadedCount} loaded, ${failedCount} failed`, 'error');
                }
            }
        }
        
        // Start loading when page loads
        document.addEventListener('DOMContentLoaded', () => {
            loadProducts();
        });
    </script>
</body>
</html>
